!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MapLibreGLComparePlus={})}(this,function(e){"use strict";function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var o,n;var i=(n||(n=1,o=function(){var e,t=arguments.length;if(1===t)e=arguments[0];else{e=[];for(var o=0;o<t;o++)e.push(arguments[o])}var n=[];function i(){e.forEach(function(e,t){e.on("move",n[t])})}function s(){e.forEach(function(e,t){e.off("move",n[t])})}function r(e,t){s(),function(e,t){var o=e.getCenter(),n=e.getZoom(),i=e.getBearing(),s=e.getPitch();t.forEach(function(e){e.jumpTo({center:o,zoom:n,bearing:i,pitch:s})})}(e,t),i()}return e.forEach(function(t,o){n[o]=r.bind(null,t,e.filter(function(e,t){return t!==o}))}),i(),function(){s(),n=[],e=[]}}),o),s=t(i);function r(e,t,o,n){if(this.options=n||{},this._mapA=e,this._mapB=t,this._horizontal="horizontal"===this.options.orientation,this._onDown=this._onDown.bind(this),this._onMove=this._onMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._ev=n.eventEmitter||new EventTarget,this._swiper=document.createElement("div"),this._swiper.className=this._horizontal?"compare-swiper-horizontal":"compare-swiper-vertical",this._controlContainer=document.createElement("div"),this._controlContainer.className=this._horizontal?"maplibregl-compare maplibregl-compare-horizontal":"maplibregl-compare",this._controlContainer.append(this._swiper),"string"==typeof o&&document.body.querySelectorAll){const e=document.body.querySelectorAll(o)[0];if(!e)throw new Error("Cannot find element with specified container selector.");e.append(this._controlContainer)}else{if(!(o instanceof Element&&o.appendChild))throw new Error("Invalid container specified. Must be CSS selector or HTML element.");o.append(this._controlContainer)}this._bounds=t.getContainer().getBoundingClientRect();const i=(this._horizontal?this._bounds.height:this._bounds.width)/2;if(this._setPosition(i),this._clearSync=s(e,t),this._onResize=function(){const o=(this._horizontal?this._bounds.height:this._bounds.width)/2;this._setPosition(o),this._bounds=e.getContainer().getBoundingClientRect(),e.triggerRepaint(),t.triggerRepaint()}.bind(this),t.on("resize",this._onResize),e.on("resize",this._onResize),window.addEventListener("resize",this._onResize),this._typeToggle=this._createTypeToggle(),"string"==typeof o&&document.body.querySelectorAll){const e=document.body.querySelectorAll(o)[0];e&&e.append(this._typeToggle)}else o instanceof Element&&o.appendChild&&o.append(this._typeToggle);this.switchType(this?.options?.type||"slider")}r.prototype={_createTypeToggle(){const e=document.createElement("div");e.className="maplibregl-compare-type-toggle";const t=document.createElement("div");t.className="toggle-prepend";const o=document.createElement("div");o.className="toggle-divide";const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("viewBox","0 0 24 24"),n.setAttribute("width","20"),n.setAttribute("height","20"),n.style.fill="currentColor";const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d","M20.5,3L20.34,3.03L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21L3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19.03 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3M10,5.47L14,6.87V18.53L10,17.13V5.47M5,6.46L8,5.45V17.15L5,18.31V6.46M16,18.55L19,17.54V5.84L16,6.85V18.55Z"),n.append(i),t.append(o),t.append(n);const s=document.createElement("input");s.type="checkbox",s.className="toggle-switch",s.checked="sideBySide"===(this?.options?.type||"slider"),s.addEventListener("change",e=>{const t=e.target.checked?"sideBySide":"slider";this.switchType(t)});const r=document.createElement("label");r.className="toggle-label",r.append(s);const h=document.createElement("div");h.className="toggle-append";const c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("viewBox","0 0 24 24"),c.setAttribute("width","20"),c.setAttribute("height","20"),c.style.fill="currentColor";const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d","M20.5,3L20.34,3.03L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21L3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19.03 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3M10,5.47L14,6.87V18.53L10,17.13V5.47M5,6.46L8,5.45V17.15L5,18.31V6.46M16,18.55L19,17.54V5.84L16,6.85V18.55Z"),c.append(a);const l=document.createElement("span");l.textContent="|",l.className="toggle-icon-divider";const d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("width","20"),d.setAttribute("height","20"),d.style.fill="currentColor";const p=document.createElementNS("http://www.w3.org/2000/svg","path");return p.setAttribute("d","M20.5,3L20.34,3.03L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21L3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19.03 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3M10,5.47L14,6.87V18.53L10,17.13V5.47M5,6.46L8,5.45V17.15L5,18.31V6.46M16,18.55L19,17.54V5.84L16,6.85V18.55Z"),d.append(p),h.append(c),h.append(l),h.append(d),e.append(t),e.append(r),e.append(h),e},_setPointerEvents(e){this._controlContainer.style.pointerEvents=e,this._swiper.style.pointerEvents=e},_onDown(e){e.touches?(document.addEventListener("touchmove",this._onMove),document.addEventListener("touchend",this._onTouchEnd)):(document.addEventListener("mousemove",this._onMove),document.addEventListener("mouseup",this._onMouseUp))},_setPosition(e){e=Math.min(e,this._horizontal?this._bounds.height:this._bounds.width);const t=this._horizontal?"translate(0, "+e+"px)":"translate("+e+"px, 0)";this._controlContainer.style.transform=t,this._controlContainer.style.WebkitTransform=t;const o=this._horizontal?"rect(0, 999em, "+e+"px, 0)":"rect(0, "+e+"px, "+this._bounds.height+"px, 0)",n=this._horizontal?"rect("+e+"px, 999em, "+this._bounds.height+"px,0)":"rect(0, 999em, "+this._bounds.height+"px,"+e+"px)";this._mapA.getContainer().style.clip=o,this._mapB.getContainer().style.clip=n,this.currentPosition=e},_onMove(e){this.options&&this.options.mousemove&&this._setPointerEvents(e.touches?"auto":"none"),this._horizontal?this._setPosition(this._getY(e)):this._setPosition(this._getX(e))},_onMouseUp(){document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onMouseUp),this.fire("slideend",{currentPosition:this.currentPosition})},_onTouchEnd(){document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd),this.fire("slideend",{currentPosition:this.currentPosition})},_getX(e){const t=(e=e.touches?e.touches[0]:e).clientX-this._bounds.left;return t<0&&(t=0),t>this._bounds.width&&(t=this._bounds.width),t},_getY(e){const t=(e=e.touches?e.touches[0]:e).clientY-this._bounds.top;return t<0?0:t>this._bounds.height?this._bounds.height:t},switchType(e="slider"){const t=this._mapA,o=this._mapB,n=(this._horizontal?this._bounds.height:this._bounds.width)/2;if(this._setPosition(n),this._typeToggle){const t=this._typeToggle.querySelector(".toggle-switch");t&&(t.checked="sideBySide"===e)}"sideBySide"===e?(t.getContainer().style.clip=null,o.getContainer().style.clip="unset",o.getContainer().style.transform="translateX(50%)",this._controlContainer.style.display="none",this.options&&this.options.mousemove&&(t.getContainer().removeEventListener("mousemove",this._onMove),o.getContainer().removeEventListener("mousemove",this._onMove)),this._swiper.removeEventListener("mousedown",this._onDown),this._swiper.removeEventListener("touchstart",this._onDown)):(this._controlContainer.style.display="inline-block",o.getContainer().style.left="-12px",o.getContainer().style.transform="none",this.options&&this.options.mousemove&&(t.getContainer().addEventListener("mousemove",this._onMove),o.getContainer().addEventListener("mousemove",this._onMove)),this._swiper.addEventListener("mousedown",this._onDown),this._swiper.addEventListener("touchstart",this._onDown))},setSlider(e){this._setPosition(e)},on(e,t){return this._ev.addEventListener(e,t),this},getPosition(){return(this._horizontal?this._bounds.height:this._bounds.width)/2},fire(e,t){return this._ev.dispatchEvent(new CustomEvent(e,{detail:t})),this},off(e,t){return this._ev.removeEventListener(e,t),this},remove(){this._clearSync(),this._mapB.off("resize",this._onResize),this._mapA.off("resize",this._onResize);const e=this._mapA.getContainer();e&&(e.style.clip=null,e.removeEventListener("mousemove",this._onMove));const t=this._mapB.getContainer();t&&(t.style.clip=null,t.removeEventListener("mousemove",this._onMove)),this._swiper.removeEventListener("mousedown",this._onDown),this._swiper.removeEventListener("touchstart",this._onDown),this._controlContainer.remove(),this._typeToggle&&this._typeToggle.parentNode&&this._typeToggle.remove()}},e.default=r,Object.defineProperty(e,"__esModule",{value:!0})});
